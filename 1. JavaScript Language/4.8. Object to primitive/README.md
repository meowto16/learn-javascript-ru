# Преобразование объекта к примитиву

Если мы складываем объекты между собой, 
либо выполняем какие-либо математические операции - они преобразуются к примитивам.

1. Все объекты в логическом контексте являются `true`
2. Численные преобразования происходят когда:
   1. Вычитаем объекты
   2. Выполняем какие-либо математические операции
3. Строковые преобразования происходят когда:
   1. Мы выводим объект `alert(obj)`
   2. Используем объект в качестве имени свойства
   3. В других случаях, где объект используется как строка

## Варианты преобразований ("хинты")

- `"string"`
  - Преобразование объекта к строке
  - Используется, когда операция ожидает получить строку
    - Например `alert(obj)` или доступ к свойству объекта `anotherObj[obj] = 123`
- `"number"`
  - Преобразование объекта к числу
  - Используется в случае математических операций.
    - Явное преобразование `Number(obj)`
    - Унарный плюс `+obj`
    - Вычитание `date1 - date2`
    - Сравнения больше/меньше
- `"default"`
  - Происходит редко, когда оператор "не уверен", какой тип ожидать. Например, при бинарном `+`
  - На практике, все встроенные объекты, исключая `Date`, реализуют `"default"` преобразования тем же способом, 
  как и `"number"`

## Процесс преобразования

1. Вызывает `obj[Symbol.toPrimitive](hint)`, если метод существует и передает ему хинт.
2. Иначе, если хинт равен `"string"`
   1. Пробует вызвать `obj.toString()`, а если его нет, то `obj.valueOf()`
3. Если хинт равен `"number"` или `"default"`
   1. Пытается вызвать `obj.valueOf()`, а если его нет, то `obj.toString()`

## Symbol.toPrimitive

```js
obj[Symbol.toPrimitive] = function(hint) {
  // должен вернуть примитивное значение
  // hint равно чему-то одному из: "string", "number" или "default"
};
```

Реальный пример:
```js
let user = {
  name: "John",
  money: 1000,

  [Symbol.toPrimitive](hint) {
    alert(`hint: ${hint}`);
    return hint == "string" ? `{name: "${this.name}"}` : this.money;
  }
};

// демонстрация результатов преобразований:
alert(user); // hint: string -> {name: "John"}
alert(+user); // hint: number -> 1000
alert(user + 500); // hint: default -> 1500
```

## Методы toString/valueOf

Примера достаточно:
```js
let user = {
  name: "John",
  money: 1000,

  // для хинта равного "string"
  toString() {
    return `{name: "${this.name}"}`;
  },

  // для хинта равного "number" или "default"
  valueOf() {
    return this.money;
  }

};

alert(user); // toString -> {name: "John"}
alert(+user); // valueOf -> 1000
alert(user + 500); // valueOf -> 1500
```
