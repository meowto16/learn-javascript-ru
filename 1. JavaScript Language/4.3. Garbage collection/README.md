# Сборка мусора

Основной концепцией управления памятью в JavaScript является принцип *достижимости*.

Достижимые значения - это те, что "достижимы" и используются. Они гарантированно находятся в памяти.

1. Существует базовое множество достижимых значений, которые не могут быть удалены.

- Локальные переменные и параметры текущей функции
- Переменные и параметры других функций в текущей цепочке вызовов.
- Глобальные переменные.

Эти значения можно называть *корнями*

2. Любое другое значение считается "достижимым", если оно доступно от корня по ссылке или цепочке ссылок.

> Он следит за всеми объектами и удаляет те, которые стали недостижимы.

## Внутренние алгоритмы

Основной алгоритм сборки мусора – «алгоритм пометок» (англ. **«mark-and-sweep»**)

- Сборщик помечает все корневые объекты
- Затем идет по ссылкам и помечает все найденные объекты
- Затем идет по ссылкам помеченных объектов.
  - Все объекты запоминаются, чтобы в будущем не посещать один и тот же объект дважды
- И так далее, пока не будут помечены все объекты от корня
- Непомеченные объекты - удаляются

#### Некоторые из оптимизаций

- Сборка по поколениям (**Generational collection**)
  - Объекты делятся на "новые" и "старые". Те, которые живут достаточно "долго" - становятся "старыми" и 
    реже проверяются оптимизатором
- Инкрементальная сборка (**Incremental collection**)
  - Интерпретатор при большом кол-ве объектов пытается организовать сборку мусора поэтапно
- Сборка в свободное время (**Idle-time collection**)
  - Интерпретатор старается запускать сборку только во время простоя процессора.


